# 实施计划：智能文件上传接口与管理页面

本计划旨在构建一个灵活且智能的文章发布系统。支持直接上传 `.md` 文件，并允许在上传时通过接口参数覆盖或补全元数据。

## 方案详情

### 核心功能
1. **灵活的元数据处理**：
   - **优先使用传入值**：如果调用接口时显式传入了 `title`, `description`, `date`, `tags` 等字段，将优先使用这些值。
   - **自动提取**：如果接口未传入且文件内缺少 Frontmatter，系统将尝试从正文首行提取标题，并自动生成描述和日期。
   - **自动合规化**：确保最终生成的 Markdown 文件包含规范的 `---` 头部信息。
2. **多目录归档**：根据 `category` 字段将文件保存至 `content/` 下对应的子文件夹（如 `tech`, `life`, `stocks`）。
3. **安全校验**：通过请求头 `Authorization: Bearer <API_KEY>` 进行验证。

---

## 拟议更改

### 后端逻辑
#### [NEW] `server/api/upload.post.ts`
- **输入**：`multipart/form-data`（包含文件流及可选的文本字段）。
- **处理管道**：
  1. 验证秘钥。
  2. 读取文件内容及表单文本字段。
  3. 合并元数据：`表单字段 > 文件内置 Frontmatter > 自动提取/默认值`。
  4. 构建新的 Markdown 字符串（包含完整的 Frontmatter）。
  5. 写入磁盘：`content/${category}/${slug}.md`。

### 管理端页面
#### [NEW] `pages/admin.vue`
- 提供文件上传控件。
- 提供额外的表单输入框，允许用户手动覆盖标题、描述等（可选）。
- 显示“发布”结果反馈。

---

## 验证计划

### 场景测试
- **场景 A**：上传纯 Markdown（无头部），手动在表单输入标题。 -> 验证生成文件包含传入标题。
- **场景 B**：仅上传文件（含头部），不输入表单字段。 -> 验证原样保存或合并默认日期。
- **场景 C**：完全“裸”文件，不输入任何信息。 -> 验证系统自动提取标题并补全。
